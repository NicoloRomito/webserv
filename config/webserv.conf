# Webserv Configuration File

# Global settings for the server
server {
    # Port to listen on, if a port is omitted the standard port is used.
    # If an address is omitted, the server listens on all addresses.
    # if the directive is not included, tha standard port is 80 and the default port is 8000.
    listen 8080;
    
    # Server name (can be used to handle different virtual hosts)
    # example.com and www.example.com will be handled.
    server_name localhost; 
    
    # Server root. Repo has to be cloned on the /Desktop
    root src/var/www/html;
    
    # Default file to serve if no specific file is requested, with the example http://localhost/
    index index.html;

    # Error pages for different status codes
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;
    
    # Limit for maximum body size (useful for file uploads)
    client_max_body_size 400000;
    
    # Enable or disable directory listing, example -> http://localhost/folder
    # If autoindex is on, the server will response with a page listing all the files and subdirectories within that one.
    # if autoindex is off, the server will display 403 (Forbidden) or 404(Not Found).
    autoindex on;

    # Define routes and their settings
    # Example -> http://localhost/
    location / {
        # Default settings for root path
        try_files $uri $ur i/ =404;
    }

    # Route for serving static files from a specific directory
    # Example -> http://localhost/static/
    location /static/ {
        alias /var/www/static/;
        autoindex off;
    }

    # Route for handling CGI scripts (e.g., PHP)
    location /cgi-bin/ {
        # Path to the CGI script interpreter
        cgi_pass /usr/bin/php-cgi;
        # Specify allowed methods
        allowed_methods GET POST;
    }

}

# Additional server (for virtual hosting on another port)
server {
    listen 8081;
    server_name example.com;

    root /var/www/example;
    index index.html;
    
    error_page 403 /errors/403.html;
    error_page 404 /errors/404.html;
}
